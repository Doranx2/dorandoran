<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/layout-cs}">

<!-- head 영역 시작 -->
<!-- 개별적으로 사용할 css, js 링크 걸기 위해 남겨둠 -->

<head>
	<th:block layout:fragment="css">
		<link rel="stylesheet" th:href="@{/css/csmain.css}" />
	</th:block>
	<th:block layout:fragment="script">
		<script th:src="@{/js/jquery-3.6.1.min.js}"></script>
		<script th:inline="javascript">
			$(function () {
			
				$("#deleteBtn").on('click', function (e) {
					e.preventDefault();

					$.ajax({
						url: '/cscenter/question',
						type: 'delete',
						data: {qNo: $("#qNo").val()},
						success: function () {
							alert("삭제되었습니다.");
							window.location.href = "/cscenter/questionList";
						},
						error: function (e) {
							console.log(e);
						}
					});
				});
			});

			function fnUpdateBoard() {
				$.ajax({
					url: '/cscenter/question',
					type: 'put',
					data: $("#updateForm").serialize(),
					success: function (obj) {
						console.log(obj);
						alert("수정되었습니다.");
						$("#qNo").val(obj.item.qNo);
						$("#qTitle").val(obj.item.qTitle);
						$("#userNo").val(obj.item.userNo);
						$("#qContent").text(obj.item.qContent);
						$("#userNm").val(obj.item.userNm);
						$("#inputDtmText").text(obj.item.inputDtm == null ?
							'' :
							obj.item.inputDtm.substring(0, 10));
						$("#inputDtm").val(obj.item.inputDtm);
					},
					error: function (e) {
						console.log(e);
					}
				});
			}
		</script>
	</th:block>
</head>
<!-- head 영역 끝 -->

<body>
	<div layout:fragment="content">
		<div class="item--68N">
			<div class="auto-group-e12j-mkJ">
				<img class="ellipse-3-VAW" src="/images/ellipse-3-fwC.png" />
				<img class="customer-survey-amico-1-dGi" src="/images/customer-survey-amico-1-3La.png" />
				<div class="item--kcE">고객센터</div>
			</div>
			<div class="auto-group-hv9g-23x">
				<div class="rectangle-23-xiJ">
					<div style="display: flex; flex-direction: column; justify-content: center; align-items: center;">
						<form id="updateForm">
							<input type="hidden" name="qNo" id="qNo" th:value="${qDetail.qNo}">
							<input type="hidden" name="inputDtm" id="inputDtm" th:value="${qDetail.inputDtm}">
							<table border="1" style="border-collapse: collapse;">
								<tr>
									<td style="background:  white; width: 70px">
										제목
									</td>
									<td style="text-align: left">
										<input type="text" name="qTitle" id="qTitle" th:value="${qDetail.qTitle}">
									</td>
								</tr>
								<tr>
									<td style="background:  white;">
										작성자
									</td>
									<td style="text-align: left">
										<input type="text" name="userNm" id="userNm" th:value="${qDetail.userNm}"readonly>
									</td>
								</tr>
								<tr>
									<td style="background:  white;">
										내용
									</td>
									<td style="text-align: left">
										<textarea name="qContent" id="qContent" cols="40" rows="10"
											th:text="${qDetail.qContent}"></textarea>
									</td>
								</tr>
								<tr>
									<td style="background:  white;">
										작성일
									</td>
									<td style="text-align: left" id="inputDtmText"
										th:text="${qDetail.inputDtm eq null ? '' : #strings.substring(qDetail.inputDtm, 0, 10)}">
									</td>
								</tr>
								<tr id="btnWrap">
									<td colspan="2" align="center">
										<button type="button" id="btnUpdate"
											th:onclick="fnUpdateBoard(); return false;">수정</button>
									</td>
								</tr>
							</table>
						</form>
						<hr />
						<a href="#" id="deleteBtn">삭제</a>
						<a href="/cscenter/questionList">뒤로가기</a>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>