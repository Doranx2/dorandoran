<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/layout-cs}">

<!-- head 영역 시작 -->
<!-- 개별적으로 사용할 css, js 링크 걸기 위해 남겨둠 -->

<head>
	<th:block layout:fragment="css">
		<link rel="stylesheet" th:href="@{/css/csmain.css}" />
	</th:block>
	<th:block layout:fragment="script">
		<script th:src="@{/js/jquery-3.6.1.min.js}"></script>
		<script th:inline="javascript">
			$(function () {
				$(".pagination a").on("click", function (e) {
					e.preventDefault();

					$("input[name='pageNum']").val($(this).attr("href"));
					$.ajax({
						url: '/cscenter/pageNoticeList',
						type: 'get',
						data: $("#searchForm").serialize(),
						success: function (obj) {
							console.log(obj);
							let htmlStr = "";
							for (let i = 0; i < obj.item.noticeList.length; i++) {
								htmlStr += `
									<tr id="eachList">
										<td>${obj.item.noticeList[i].noticeNo}</td>
										<td>
											<a href="/cscenter/notice/${obj.item.noticeList[i].noticeNo}">
												${obj.item.noticeList[i].noticeTitle}
											</a>
										</td>
										<td>
											${obj.item.noticeList[i].inputDtm == null ? '' : obj.item.noticeList[i].inputDtm.substring(0, 10)}
										</td>
									</tr>
								`;
							}
							$("#boardTable").children(":first").children().not(':first').remove();
							$("#boardTable").children(":first").append(htmlStr);

						},
						error: function (e) {
							console.log(e);
						}
					});
				});

				$("#btnSearch").on("click", function () {
					$("input[name='pageNum']").val(1);

					$("#searchForm").submit();
				});
			});
		</script>
	</th:block>
</head>
<!-- head 영역 끝 -->

<body>
	<div layout:fragment="content">
		<div class="item--68N">
			<div class="auto-group-e12j-mkJ">
				<img class="ellipse-3-VAW" src="/images/ellipse-3-fwC.png" />
				<img class="customer-survey-amico-1-dGi" src="/images/customer-survey-amico-1-3La.png" />
				<div class="item--kcE">고객센터</div>
			</div>
			<div class="auto-group-hv9g-23x">
				<div class="rectangle-23-xiJ">
					<div style="display: flex; flex-direction: column; justify-content: center; align-items: center;"
						id="table1">
						<div id="tpImg">
							<div>
								<img th:src="@{/images/-ib8.png}" style="width : 80px; height : 80px;">
							</div>
							<div>
								<span id="listTtl">공지사항</span>
							</div>
						</div>
						<form id="searchForm">
							<input type="hidden" name="pageNum" th:value="${pageDTO.cri.pageNum }">
							<input type="hidden" name="amount" th:value="${pageDTO.cri.amount }">
							<table style="width: 950px; border-collapse: collapse; margin-top: px;">
								<tr>
									<td align="right">
										<select name="searchCondition">
											<option value="ALL" th:selected="${searchCondition == 'ALL'}">전체</option>
											<option value="TITLE" th:selected="${searchCondition == 'TITLE'}">제목
											</option>
											<option value="CONTENT" th:selected="${searchCondition == 'CONTENT'}">내용
											</option>
										</select>
										<input type="text" name="searchKeyword" th:value="${searchKeyword}">
										<button type="button" id="btnSearch">검색</button>
									</td>
								</tr>
							</table>
						</form>

						<table id="boardTable"
							style="width: 950px; border-collapse: collapse; margin-top:10px;table-layout:fixed;">
							<tr id="tbHead">
								<th
									style="background-Color : #1761A0; width: 15%; height:50px; border-top-left-radius:10px;">
									번호</th>
								<th style="background-Color : #1761A0; width: 60%;">제목</th>
								<th style="background-Color : #1761A0; width: 25%; border-top-right-radius:10px;">등록일
								</th>
							</tr>
							<tr th:each="notice : ${noticeList}" id="eachList">
								<td th:text=${notice.noticeNo}></td>
								<td>
									<a th:text="${notice.noticeTitle}"
										th:href="@{/cscenter/notice/{noticeNo} (noticeNo=${notice.noticeNo})}">
									</a>
								</td>
								<td
									th:text="${notice.inputDtm eq null ? '' : #strings.substring(notice.inputDtm, 0, 10)}">
								</td>
							</tr>
						</table>
						<table style="width: 950px; border-collapse: collapse;table-layout:fixed;">
							<tr>
								<th
									style="background-Color : #1761A0; width: 15%; height:10px; border-bottom-left-radius:10px;">
								</th>
								<th style="background-Color : #1761A0; width: 60%;"></th>
								<th style="background-Color : #1761A0; width: 25%; border-bottom-right-radius:10px;">
								</th>
							</tr>
						</table>
						<br />
						<div id="pageDiv">
							<ul class="pagination">
								<li th:if="${pageDTO.prev }" class="pagination_button">
									<a th:href="${pageDTO.cri.pageNum - 1 }"><img th:src="@{/images/leftArrow.png}"></a>
								</li>


								<li th:each="num : ${#numbers.sequence(pageDTO.startPage, pageDTO.endPage)} "
									class="pagination_num">
									<a th:href="${num }" th:text="${num}"></a>
								</li>

								<li th:if="${pageDTO.next }" class="pagination_button">
									<a th:href="${pageDTO.cri.pageNum + 1 }"><img
											th:src="@{/images/rightArrow.png}"></a>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>